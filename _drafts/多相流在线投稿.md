---
layout:     post
title:      OpenFOAM-v1706ä¸­é‡å ç½‘æ ¼çš„ç½‘æ ¼æ“ä½œæµç¨‹
subtitle:    ""
date:       2017-12-21
author:     Mao Yanjun
header-img: img/post-myj-oversetmesh.png
catalog: true
tags:
    - OpenFOAM
    - overset Mesh
    - CFD
---

> â€œğŸ™‰ğŸ™‰ğŸ™‰ â€

> **æœ¬å¸–æ–°æ‰‹æ‰€å†™ï¼Œç†è®ºä¸ä¸¥è°¨ï¼Œä»£ç ä¸ç®€æ´ï¼Œé€»è¾‘ä¸æ¸…æ™°ï¼Œä»…ä¾›å­¦ä¹ è®°å½•å‚è€ƒ**

# å…³äºé‡å ç½‘æ ¼çš„ç½‘æ ¼æ“ä½œæµç¨‹

ä»¥overInterDyMFoam ä¸­çš„floatingBody Caseä¸ºä¾‹ç®€å•ä»‹ç»é‡å ç½‘æ ¼çš„ç½‘æ ¼æ“ä½œæµç¨‹ã€‚ç®—ä¾‹æ‰€åœ¨ç›®å½•ä¸ºtutorials/multiphase/overInterDyMFoam/floatingBody

å› ä¸ºovermeshçš„åŸç†æ˜¯ä½¿ç”¨ä¸¤å¥—ç½‘æ ¼ï¼Œå¹¶é€šè¿‡oversetåŒºåŸŸè¿›è¡Œæ’å€¼ä¼ é€’ä¿¡æ¯ã€‚å› æ­¤ç®—ä¾‹ç›®å½•ä¸­æœ‰background å’Œ floatingBody ä¸¤ä¸ªæ–‡ä»¶å¤¹ã€‚é¦–å…ˆæˆ‘ä»¬é€šè¿‡ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„Allrun.preæ–‡ä»¶å¯ä»¥çœ‹åˆ°å…¶åœ¨æ¯ä¸ªæ–‡ä»¶å¤¹ä¸­çš„æ“ä½œæµç¨‹ã€‚ç®€å•è¯´floatingBodyåªè¿›è¡Œäº†æµ®ä½“ç½‘æ ¼çš„è®¾ç½®å’Œè¾¹ç•Œåç§°çš„è®¾ç½®ã€‚é€šè¿‡`mergemeshes`å‘½ä»¤å¯ä»¥å°†floatingBody ä¸­ç”Ÿæˆçš„ç½‘æ ¼æ–‡ä»¶mergeåˆ°backgroundçš„ç½‘æ ¼ä¸­ï¼Œå‰©ä¸‹çš„æ“ä½œéƒ½åœ¨backgroundæ–‡ä»¶å¤¹ä¸­è¿›è¡Œã€‚

Allrun è„šæœ¬å®ä¾‹å’Œæ³¨é‡Šå¦‚ä¸‹ï¼Œæ³¨é‡Šä¸­è¯¦ç»†è§£é‡Šäº†æ¯ä¸ªå‘½ä»¤çš„æ“ä½œæ„ä¹‰ï¼š

```
Allrun.pre IN floatingBody
#!/bin/sh
cd ${0%/*} || exit 1    # run from this directory

# Source tutorial run functions
. $WM_PROJECT_DIR/bin/tools/RunFunctions

# Set application name
application=`getApplication`

runApplication blockMesh #blockMeshå®šä¹‰äº†é‡å ç½‘æ ¼çš„æ•´ä¸ªç½‘æ ¼åŒºåŸŸ
runApplication topoSet #topoSetæ ‡è®°äº†æµ®ä½“çš„å½¢çŠ¶å’Œä½ç½®çš„Cellï¼Œå¹¶æ‰£é™¤æ ‡è®°åŒºåŸŸç½‘æ ¼ï¼Œ ç•™ä¸‹çš„é‡å åŸŸç½‘æ ¼ä¸ºé™¤å»æµ®ä½“å†…éƒ¨çš„æ‰€æœ‰Cell
runApplication subsetMesh -overwrite c0 -patch floatingObject #å¯¹c0åŸŸæ·»åŠ è¾¹ç•Œ,è¾¹ç•Œåå­—ä¸ºfloatingOject

# ----------------------------------------------------------------- end-of-file
Allrun.pre IN background

#!/bin/sh
cd ${0%/*} || exit 1    # Run from this directory
. $WM_PROJECT_DIR/bin/tools/RunFunctions

# Create background mesh
runApplication blockMesh

# Add the cylinder mesh
runApplication mergeMeshes . ../floatingBody â€“overwrite #å…³é”®çš„ä¸€æ­¥æ˜¯å°†floatingBodyçš„ç½‘æ ¼èåˆè¿›äº†èƒŒæ™¯ç½‘æ ¼ä¸­ã€‚
#æ­¤å¤„éœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œoverset mesh å’Œ background mesh çš„åæ ‡èŒƒå›´ä¸€å®šè¦ç»Ÿä¸€ï¼Œè¿™æ ·æ‰å¯ä»¥é‡å åœ¨ä¸€èµ·ã€‚å› æ­¤ä¸¤å¥—ç½‘æ ¼çš„åæ ‡ç‚¹è®¾ç½®ç»Ÿä¸€å¾ˆé‡è¦ã€‚

# Select cellSets for the different zones
runApplication topoSet #è¯¦è§ç¬¬äºŒèŠ‚ ToposetdictDict çš„ä»‹ç»ä¸ä½¿ç”¨ï¼šå¯¹è®¡ç®—åŸŸCellè¿›è¡Œäº†æ ‡è®°,ä¾¿äºåº”ç”¨setFieldsè¿›è¡Œåˆå§‹åœºçš„è®¾ç½®.

restore0Dir

# Use cellSets to write zoneID
runApplication setFields #è¯¦è§ç¬¬ä¸‰èŠ‚è®¾ç½®åˆå§‹åœºå€¼ï¼Œä»¥åŠç”¨ï¼ˆ0ï¼Œ1ï¼‰æ ‡è®°ç½‘æ ¼åŒºåŸŸzoneID.

runApplication decomposePar
#------------------------------------------------------------------------------

```

# TopoSetDict çš„ä»‹ç»å’Œä½¿ç”¨

ç”±ä¸Šè¿° background ä¸­çš„ Allrun.pre æ–‡ä»¶ä¸­çš„æ“ä½œå‘½ä»¤å¯ä»¥çœ‹åˆ°ï¼Œèåˆç½‘æ ¼åï¼Œéœ€è¦è®¾ç½®zoneIDæ¥æ ‡è®°ä¸åŒçš„ç½‘æ ¼åŒºåŸŸ,æ­¤å¤„éœ€è¦é¦–å…ˆç”¨toposet å·¥å…·æ¥æ ‡è®°ç½‘æ ¼åŒºåŸŸã€‚æ§åˆ¶å­—å…¸å¦‚ä¸‹ï¼š


```
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    object      topoSetDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

actions
(
    //é¦–å…ˆæ ‡è®° C0ç½‘æ ¼åŒºåŸŸä¸ºæ•´ä¸ªèƒŒæ™¯ç½‘æ ¼ï¼Œé‡‡ç”¨ insidepoints çš„æ–¹å¼æ¥è¿›è¡Œè®¾ç½®ã€‚ä¼šè‡ªåŠ¨å¯»æ‰¾åˆ°æ•´ä¸ªè¾¹ç•ŒåŒºåŸŸï¼Œç„¶åæ ‡è®°æ•´ä¸ªç½‘æ ¼åŒºåŸŸä¸ºc0
    {
        name    c0;
        type    cellSet;
        action  new;
        source  regionToCell;
        sourceInfo
        {
            insidePoints ((12.0 0.05 1.0));//æ­¤å¤„è¯¥ç‚¹ä¸€å®šè¦è®¾ç½®åœ¨æ‰£å‡ºæµ®ä½“çš„å†…éƒ¨ï¼Œå¦åˆ™ä¼šå‡ºç°é‡å ç½‘æ ¼å’ŒèƒŒæ™¯ç½‘æ ¼ä¹‹é—´çš„ä¸è€¦åˆç°è±¡ã€‚
        }
    }

    //ç„¶åé€šè¿‡c0åŒºåŸŸæ¥æ ‡è®°c1åŒºåŸŸ

    {
        name    c1;
        type    cellSet;
        action  new;
        source  cellToCell;
        sourceInfo
        {
            set c0;
        }
    }

    //æœ€åé€šè¿‡åé€‰å®ç° æ ‡è®°é™¤å»c0åŒºåŸŸå¤–çš„ç½‘æ ¼åŒºåŸŸä¸ºc1

    {
        name    c1;
        type    cellSet;
        action  invert;
    }
);

// ************************************************************************* //

```



# setField å¯¹æµä½“åŸŸè¿›è¡Œå®šä¹‰

ä¸Šè¿°çš„åœ¨backgroundä¸­çš„topoSetDict å·²ç»è®¾ç½®äº† C0ï¼ˆèƒŒæ™¯ç½‘æ ¼åŒºåŸŸï¼‰ å’ŒC1ï¼ˆé‡å ç½‘æ ¼åŒºåŸŸï¼‰ã€‚ ç„¶åé€šè¿‡setFieldè¿›è¡Œalphawaterçš„è®¾ç½®å’ŒzoneIDçš„è®¾ç½®ã€‚alphawaterçš„è®¾ç½®åŒä¼ ç»Ÿç®—ä¾‹ï¼Œåœ¨æ­¤ä¸è¯¦è¿°ã€‚è¿™é‡Œä¸»è¦è®²ä¸€ä¸‹å…³äºzoneIDçš„åˆå§‹åœºå€¼çš„è®¾ç½®ã€‚å…¶ä¸­c0 zone è¢«å®šä¹‰ä¸º0ã€‚C1 zone è®¾ç½®ä¸º1ã€‚

```
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    object      setFieldsDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

defaultFieldValues
(
    volScalarFieldValue alpha.water 0
    volScalarFieldValue zoneID 123
);

regions
(
    boxToCell
    {
        box ( -100 -100 -100 ) ( 100 100 1.0 );
        fieldValues ( volScalarFieldValue alpha.water 1 );
    }

 /*   boxToCell
    {
        box ( 0.7 0.8 -100 ) ( 100 100 0.75 );
        fieldValues ( volScalarFieldValue alpha.water 1 );
    }*/
    cellToCell
    {
        set c0;

        fieldValues
        (
            volScalarFieldValue zoneID 0
        );
    }
    cellToCell
    {
        set c1;

        fieldValues
        (
            volScalarFieldValue zoneID 1
        );
    }

);

// ************************************************************************* //

```
ä¸Šè¿°è®¾ç½®ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºåˆ†åˆ«æ ‡è®°çš„ c0åŒºåŸŸå’Œc1åŒºåŸŸ
![oversetmesh-zoneID](oversetmesh-zoneID)

#  é‡å ç½‘æ ¼è¾¹ç•Œä¸­çš„ç‰¹æ®Šè¾¹ç•Œ

é‡å ç½‘æ ¼ä¸­è®¾ç½®äº†ä¸¤ä¸ªä¸åŒåŒºåŸŸçš„ç½‘æ ¼ï¼Œè€Œä¸¤å¥—ç½‘æ ¼ä¹‹é—´éœ€è¦é€šè¿‡ `overset`è¾¹ç•Œæ¥è¿›è¡Œå®šä¹‰æ’å€¼å•å…ƒç½‘æ ¼çš„ã€‚å› æ­¤ä¸‹é¢ä»‹ç»ä¸€ä¸‹é‡å ç½‘æ ¼ç®—ä¾‹ä¸­çš„å‡ ä¸ªé‡è¦è¾¹ç•Œã€‚

![é‡å ç½‘æ ¼ç¤ºæ„å›¾](https://i.imgur.com/iLUZM7I.png)

å›¾ä¸­çš„overset Boundary ä¾¿æ˜¯floatingbodyä¸­å®šä¹‰çš„sidesï¼Œå¦‚ä¸‹è¾¹ç•Œæ¡ä»¶æ–‡ä»¶æ‰€ç¤ºï¼Œå…¶è¾¹ç•Œç±»å‹ä¸º `overset`ã€‚å›¾ä¸­çš„wall boundaries åˆ™æ˜¯floatingObject è¾¹ç•Œã€‚


	```
	    sides
	    {
	        type            overset;
	        inGroups        1(overset);
	        nFaces          300;
	        startFace       227915;
	    }
	
	```

æ­¤è¾¹ç•Œæ˜¯å®šä¹‰åœ¨ floatingBody ä¸­ï¼Œæœ€åmergeåˆ° background ç½‘æ ¼ä¸Šï¼Œæ˜¯è¿›è¡Œé‡å åŸŸæ ‡è®°å’Œä¿¡æ¯ä¼ é€’çš„é‡è¦è¾¹ç•Œæ¡ä»¶ï¼Œå…·ä½“å®ç°å¾…è¡¥å……ã€‚


```
    sides2
    {
        type            empty;
        inGroups        1(empty);
        nFaces          9032;
        startFace       228215;
    }

```
æ­¤è¾¹ç•Œæ¡ä»¶æ˜¯ floatingBodyä¸­çš„å‰åé¢ï¼Œåœ¨ æ›´æ”¹ä¸º2Dç®—ä¾‹çš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½®ä¸º emptyï¼Œ3Dç®—ä¾‹æ—¶ï¼Œä¹Ÿåº”è¯¥è®¾ç½®ä¸º``overset``ã€‚


```
    oversetPatch
    {
        type            overset;
        inGroups        1(overset);
        nFaces          0;
        startFace       116951;
    }
    atmosphere
    {
        type            patch;
        inGroups        1(patch);
        nFaces          713;
        startFace       116951;
    }

```
ä¸€ä¸ªç‰¹æ®Šçš„è¾¹ç•Œï¼Œåšä»€ä¹ˆç”¨çš„æš‚æ—¶ä¸çŸ¥é“ï¼Œè¾¹ç•Œé¢è®¾ç½®ä¸º0ä¸ªã€‚startFace ä¸ºæ•´ä¸ªè¾¹ç•Œç¼–å·ä¸­çš„èµ·å§‹ç¼–å·ã€‚å¦‚ä¸Šé¢æ‰€ç¤ºå‚ç…§atmosphereè¾¹ç•Œã€‚å¦‚æœæ²¡æœ‰æ­¤è¾¹ç•Œï¼Œlog æ–‡ä»¶ä¸­ä¼šå‡ºç° warning å¤§æ¦‚æ˜¯ oversetPatch ä¸æ˜¯è®¡ç®—åŸŸä¸­çš„ç¬¬ä¸€ä¸ªèµ·å§‹ç¼–å·ã€‚


**æœ€åå…³äºtopoSet, setFields, refinemesh,ç­‰ç½‘æ ¼å’Œå‰å¤„ç†å·¥å…·ï¼Œå¯åœ¨ä»£ç ä¸­application/utilities/ä¸­çœ‹åˆ°è¯¦ç»†çš„Dictè®¾ç½®æŒ‡å¯¼ã€‚ä»¥åŠå®ç°çš„æºä»£ç ã€‚**













